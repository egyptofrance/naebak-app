# ุฎุทุฉ ุชุทููุฑ ุงููููุฒุงุช ุงูุฌุฏูุฏุฉ v1.3.0

## ๐ ุงููุชุทูุจุงุช

### 1. ุตูุญุงุช ุงููุณุชุฎุฏููู (User Profiles)

#### ููููุงุทู (Citizen)
- **ุงููุณุงุฑ:** `/citizen/[user_id]` ุฃู `/profile/[slug]`
- **ุงูุฃูุณุงู:**
  - ุงูุจูุงูุงุช ุงูุดุฎุตูุฉ (ุงูุงุณูุ ุงูุตูุฑุฉุ ุงููุญุงูุธุฉุ ุงููุฏููุฉุ ุงููุธููุฉ)
  - ุฅุฏุงุฑุฉ ุงูุฑุณุงุฆู (ุงูุฑุณุงุฆู ุงููุฑุณูุฉ ูุงููุณุชูุจูุฉ)
  - ุฅุฏุงุฑุฉ ุงูุดูุงูู (ุงูุดูุงูู ุงูููุฏูุฉ ูุญุงูุชูุง)

#### ูููุงุฆุจ (MP)
- **ุงููุณุงุฑ:** `/mp/[slug]`
- **ุงูุฃูุณุงู:**
  - ุงูุจูุงูุงุช ุงูุดุฎุตูุฉ ูุงูููููุฉ
  - ุงููุฌูุณ (ูุฌูุณ ุงูููุงุจ / ูุฌูุณ ุงูุดููุฎ)
  - ุงูุญุฒุจ / ูุณุชูู
  - ุงูุฏุงุฆุฑุฉ ุงูุงูุชุฎุงุจูุฉ
  - ุงูุฑูุฒ ุงูุงูุชุฎุงุจู
  - ุฅุฏุงุฑุฉ ุงูุฑุณุงุฆู
  - ุฅุฏุงุฑุฉ ุงูุดูุงูู ุงููููู ุจูุง
  - ุงููุญุชูู (ุฅูุฌุงุฒุงุชุ ูุนุงููุงุชุ ุจุฑุงูุฌ)
  - ุงูููุงุท ุงูููุชุณุจุฉ

#### ูููุฑุดุญ (Candidate)
- **ุงููุณุงุฑ:** `/candidate/[slug]`
- **ุงูุฃูุณุงู:** ููุณ ุฃูุณุงู ุงููุงุฆุจ

### 2. ุชุญุฏูุซ Header ุจุนุฏ ุชุณุฌูู ุงูุฏุฎูู

#### ูุจู ุชุณุฌูู ุงูุฏุฎูู
- ุฒุฑ "ุชุณุฌูู"
- ุฒุฑ "ุฏุฎูู"

#### ุจุนุฏ ุชุณุฌูู ุงูุฏุฎูู
- ุงุณู ุงููุณุชุฎุฏู (ุงูุงุณู ุงูุฃูู + ุงูุฃุฎูุฑ)
- ูุงุฆูุฉ ููุณุฏูุฉ ุชุญุชูู ุนูู:
  - "ููุญุฉ ุงูุชุญูู" โ ููุฌู ุฅูู `/dashboard` ุฃู ูุจุงุดุฑุฉ ุฅูู ููุญุฉ ุงูุชุญูู ุงูุฎุงุตุฉ ุจุงูุฏูุฑ
  - "ุชุณุฌูู ุงูุฎุฑูุฌ" โ ูููู ุจุชุณุฌูู ุงูุฎุฑูุฌ

### 3. ุชุญุฏูุซ ูููุฐุฌ ุงูุชุณุฌูู

#### ุงูุญููู ุงูุญุงููุฉ (ููุฌูุฏุฉ)
- ุงูุงุณู ุงูุฃูู ูุงูุฃุฎูุฑ โ
- ุงูุจุฑูุฏ ุงูุฅููุชุฑููู โ
- ูููุฉ ุงููุฑูุฑ โ
- ุฑูู ุงููุงุชู ูุงููุงุชุณุงุจ โ
- ุงููุญุงูุธุฉ โ
- ุงููุฏููุฉ ูุงููุฑูุฉ โ
- ุชุงุฑูุฎ ุงููููุงุฏ โ
- ุงูุฌูุณ โ
- ุงููุธููุฉ โ

#### ุงูุญููู ุงููุทููุจ ุฅุถุงูุชูุง
- **ููุน ุงูุญุณุงุจ** (dropdown):
  - ููุงุทู (ุงูุชุฑุงุถู)
  - ูุงุฆุจ ุญุงูู
  - ูุฑุดุญ

- **ุฅุฐุง ุงุฎุชุงุฑ "ูุงุฆุจ ุญุงูู":**
  - ุงููุฌูุณ (dropdown): ูุฌูุณ ุงูููุงุจ / ูุฌูุณ ุงูุดููุฎ
  - ุงูุญุฒุจ (dropdown): ูุงุฆูุฉ ุงูุฃุญุฒุงุจ + ูุณุชูู
  - ุงูุฏุงุฆุฑุฉ ุงูุงูุชุฎุงุจูุฉ (text)
  - ุงูุฑูุฒ ุงูุงูุชุฎุงุจู (dropdown)
  - ุงูุฑูู ุงูุงูุชุฎุงุจู (text)
  - ุงููุฌูุฉ (text)

- **ุฅุฐุง ุงุฎุชุงุฑ "ูุฑุดุญ":**
  - ุงููุฌูุณ (dropdown): ูุฌูุณ ุงูููุงุจ / ูุฌูุณ ุงูุดููุฎ
  - ุงูุญุฒุจ (dropdown): ูุงุฆูุฉ ุงูุฃุญุฒุงุจ + ูุณุชูู
  - ุงูุฏุงุฆุฑุฉ ุงูุงูุชุฎุงุจูุฉ (text)
  - ุงูุฑูุฒ ุงูุงูุชุฎุงุจู (dropdown)
  - ุงูุฑูู ุงูุงูุชุฎุงุจู (text)

---

## ๐๏ธ ุจููุฉ ูุงุนุฏุฉ ุงูุจูุงูุงุช

### ุงูุฌุฏุงูู ุงูุฑุฆูุณูุฉ

#### `users`
```sql
- id (uuid, PK)
- auth_id (uuid, FK to auth.users)
- role_id (bigint, FK to roles)
- first_name (text)
- last_name (text)
- email (text, unique)
- dob (date)
- governorate_id (bigint, FK to governorates)
- city (text)
- village (text)
- phone (text)
- whatsapp (text)
- avatar (text)
- job_title (text)
- gender (text: "ุฐูุฑ"/"ุฃูุซู")
- total_points (int, default 0)
- created_at (timestamptz)
- updated_at (timestamptz)
```

#### `profiles` (ููููุงุจ ูุงููุฑุดุญูู ููุท)
```sql
- user_id (uuid, PK, FK to users)
- council_id (bigint, FK to councils)
- party_id (bigint, FK to parties)
- is_independent (boolean)
- electoral_symbol_id (bigint, FK to symbols)
- electoral_number (text)
- district (text)
- committee (text)
- banner_path (text)
- slug (text, unique)
- created_at (timestamptz)
```

#### `roles`
```sql
- id (bigint, PK)
- name (text): "admin", "manager", "citizen", "mp", "candidate"
```

#### `councils`
```sql
- id (bigint, PK)
- name (text): "ูุฌูุณ ุงูููุงุจ", "ูุฌูุณ ุงูุดููุฎ"
```

#### `parties`
```sql
- id (bigint, PK)
- name (text): "ูุณุชูู", "ุญุฒุจ ุงูููุฏ", "ุญุฒุจ ุญูุงุฉ ูุทู", ุฅูุฎ.
```

#### `symbols`
```sql
- id (bigint, PK)
- name (text)
- icon_path (text)
```

#### `messages`
```sql
- id (bigint, PK)
- from_user_id (uuid, FK to users)
- to_user_id (uuid, FK to users)
- body (text, max 500 chars)
- is_approved (boolean, default false)
- created_at (timestamptz)
```

#### `complaints`
```sql
- id (bigint, PK)
- citizen_id (uuid, FK to users)
- title (varchar 100)
- body (varchar 1500)
- type_id (bigint, FK to complaint_types)
- governorate_id (bigint, FK to governorates)
- agree_publish_public (boolean)
- assigned_to (uuid, FK to users)
- assigned_by (uuid, FK to users)
- status (text: "new", "assigned", "responded", ุฅูุฎ.)
- points_awarded (int)
- assigned_at (timestamptz)
- hold_until (timestamptz)
- due_date (timestamptz)
- created_at (timestamptz)
```

---

## ๐ฏ ุฎุทุฉ ุงูุชูููุฐ

### ุงููุฑุญูุฉ 1: ุชุญุฏูุซ ูููุฐุฌ ุงูุชุณุฌูู โ (ุณูุจุฏุฃ ุจูุง)

#### 1.1. ุฌูุจ ุงูุจูุงูุงุช ุงููุฑุฌุนูุฉ ูู Supabase
- ุฌูุจ `councils` (ุงููุฌุงูุณ)
- ุฌูุจ `parties` (ุงูุฃุญุฒุงุจ)
- ุฌูุจ `symbols` (ุงูุฑููุฒ ุงูุงูุชุฎุงุจูุฉ)

#### 1.2. ุชุญุฏูุซ `RegisterForm.tsx`
- ุฅุถุงูุฉ ุญูู "ููุน ุงูุญุณุงุจ" (dropdown)
- ุฅุถุงูุฉ ุญููู ุงููุงุฆุจ/ุงููุฑุดุญ (ุชุธูุฑ conditionally)
- ุชุญุฏูุซ validation
- ุชุญุฏูุซ API call ูุฅูุดุงุก ุงูุญุณุงุจ

#### 1.3. ุชุญุฏูุซ API `/api/auth/signup`
- ุฅูุดุงุก user ูู `users` table
- ุฅุฐุง ูุงู ูุงุฆุจ ุฃู ูุฑุดุญุ ุฅูุดุงุก profile ูู `profiles` table
- ุฑุจุท `auth_id` ูุน Supabase Auth
- ุชุนููู `role_id` ุงูุตุญูุญ

### ุงููุฑุญูุฉ 2: ุตูุญุงุช ุงููุณุชุฎุฏููู (User Profiles)

#### 2.1. ุตูุญุฉ ุงูููุงุทู
- `app/citizen/[id]/page.tsx`
- ุนุฑุถ ุงูุจูุงูุงุช ุงูุดุฎุตูุฉ
- ูุณู ุงูุฑุณุงุฆู
- ูุณู ุงูุดูุงูู

#### 2.2. ุตูุญุฉ ุงููุงุฆุจ
- `app/mp/[slug]/page.tsx`
- ุนุฑุถ ุงูุจูุงูุงุช ุงูุดุฎุตูุฉ ูุงูููููุฉ
- ูุณู ุงูุฑุณุงุฆู
- ูุณู ุงูุดูุงูู
- ูุณู ุงููุญุชูู
- ุนุฑุถ ุงูููุงุท

#### 2.3. ุตูุญุฉ ุงููุฑุดุญ
- `app/candidate/[slug]/page.tsx`
- ููุณ ูุญุชูู ุตูุญุฉ ุงููุงุฆุจ

### ุงููุฑุญูุฉ 3: ุชุญุฏูุซ Header

#### 3.1. ุฅูุดุงุก ูููู `UserMenu`
- ุนุฑุถ ุงุณู ุงููุณุชุฎุฏู
- ูุงุฆูุฉ ููุณุฏูุฉ
- ุฑุงุจุท ููุญุฉ ุงูุชุญูู
- ุฒุฑ ุชุณุฌูู ุงูุฎุฑูุฌ

#### 3.2. ุชุญุฏูุซ `Header.tsx`
- ุงุณุชุฎุฏุงู `getUser()` ููุชุญูู ูู ุชุณุฌูู ุงูุฏุฎูู
- ุนุฑุถ `UserMenu` ุฅุฐุง ูุงู ูุณุฌู ุฏุฎูู
- ุนุฑุถ ุฃุฒุฑุงุฑ "ุชุณุฌูู" ู "ุฏุฎูู" ุฅุฐุง ูู ููู ูุณุฌู ุฏุฎูู

### ุงููุฑุญูุฉ 4: ููุญุงุช ุงูุชุญูู (Dashboards)

#### 4.1. Citizen Dashboard
- `app/dashboard/citizen/page.tsx`
- ุนุฑุถ ููุฎุต ุงูุฑุณุงุฆู ูุงูุดูุงูู
- ุฑูุงุจุท ุณุฑูุนุฉ

#### 4.2. MP Dashboard
- `app/dashboard/mp/page.tsx`
- ุนุฑุถ ููุฎุต ุงูุฑุณุงุฆู ูุงูุดูุงูู ุงููููู ุจูุง
- ุนุฑุถ ุงูููุงุท
- ุฅุฏุงุฑุฉ ุงููุญุชูู

#### 4.3. Candidate Dashboard
- `app/dashboard/candidate/page.tsx`
- ููุณ ูุญุชูู MP Dashboard

---

## ๐ ุงููููุงุช ุงููุทููุจ ุฅูุดุงุคูุง/ุชุนุฏูููุง

### ุชุนุฏููุงุช
1. `components/auth/RegisterForm.tsx` - ุชุญุฏูุซ ุงููููุฐุฌ
2. `components/layout/Header.tsx` - ุฅุถุงูุฉ UserMenu
3. `lib/auth.ts` - ุฅุถุงูุฉ ุฏูุงู ุฌุฏูุฏุฉ
4. `app/(auth)/register/page.tsx` - ุชุญุฏูุซ ุงูุตูุญุฉ

### ูููุงุช ุฌุฏูุฏุฉ
1. `components/auth/UserMenu.tsx` - ูุงุฆูุฉ ุงููุณุชุฎุฏู ุงูููุณุฏูุฉ
2. `app/citizen/[id]/page.tsx` - ุตูุญุฉ ุงูููุงุทู
3. `app/mp/[slug]/page.tsx` - ุตูุญุฉ ุงููุงุฆุจ
4. `app/candidate/[slug]/page.tsx` - ุตูุญุฉ ุงููุฑุดุญ
5. `app/dashboard/citizen/page.tsx` - ููุญุฉ ุชุญูู ุงูููุงุทู
6. `app/dashboard/mp/page.tsx` - ููุญุฉ ุชุญูู ุงููุงุฆุจ
7. `app/dashboard/candidate/page.tsx` - ููุญุฉ ุชุญูู ุงููุฑุดุญ
8. `lib/supabase-queries.ts` - ุฏูุงู ุฌูุจ ุงูุจูุงูุงุช ูู Supabase

---

## โ๏ธ ูุชุบูุฑุงุช ุงูุจูุฆุฉ ุงููุทููุจุฉ

ูุฌุจ ุงูุชุฃูุฏ ูู ูุฌูุฏ ูุฐู ุงููุชุบูุฑุงุช ูู `.env.local` ู Vercel:

```env
NEXT_PUBLIC_SUPABASE_URL=https://hgnsgecejirhafynztdi.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
SUPABASE_SERVICE_ROLE_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
```

---

## ๐ ุงูุจุฏุก ูู ุงูุชูููุฐ

ุณูุจุฏุฃ ุจุงููุฑุญูุฉ 1: ุชุญุฏูุซ ูููุฐุฌ ุงูุชุณุฌูู

### ุงูุฎุทูุงุช:
1. โ ุฌูุจ ุงูุจูุงูุงุช ุงููุฑุฌุนูุฉ ูู Supabase
2. โ ุชุญุฏูุซ `RegisterForm.tsx`
3. โ ุชุญุฏูุซ API signup
4. โ ุงูุงุฎุชุจุงุฑ

---

**ุชุงุฑูุฎ ุงูุฅูุดุงุก:** 2025-10-06  
**ุงูุฅุตุฏุงุฑ ุงููุณุชูุฏู:** v1.3.0  
**ุงูุญุงูุฉ:** ๐ง ููุฏ ุงูุชุทููุฑ
